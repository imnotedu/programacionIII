<main class="flex-1 py-8 md:py-12">
  <div class="container mx-auto px-4 md:px-8">
    <!-- Back Button -->
    <button onclick="history.back()" class="flex items-center gap-2 text-muted-foreground hover:text-foreground transition-colors mb-6">
      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
      </svg>
      Volver
    </button>

    <div class="grid md:grid-cols-2 gap-8">
      <!-- Product Image -->
      <div class="bg-white rounded-lg p-4 flex items-center justify-center">
        <img
          src="<%= product.image || '/placeholder.png' %>"
          alt="<%= product.name %>"
          class="max-h-[500px] object-contain"
          loading="lazy"
          onerror="this.src='/placeholder.svg'"
        />
      </div>

      <!-- Product Info -->
      <div class="space-y-6">
        <!-- Title and Badges -->
        <div>
          <h1 class="text-3xl font-bold text-foreground"><%= product.name %></h1>
          <div class="flex gap-2 mt-2">
            <% if (product.isNew) { %>
              <span class="badge-new">Nuevo</span>
            <% } %>
            <% if (product.isSale) { %>
              <span class="badge-sale">Oferta</span>
            <% } %>
          </div>
        </div>

        <!-- Price -->
        <div class="space-y-2">
          <% if (product.isSale && product.originalPrice) { %>
            <div class="text-2xl text-gray-500 line-through">
              $<%= product.originalPrice.toFixed(2) %>
            </div>
            <div class="text-4xl font-bold text-primary">
              $<%= product.price.toFixed(2) %>
            </div>
            <div class="text-sm text-primary font-semibold">
              Ahorra $<%= (product.originalPrice - product.price).toFixed(2) %> (<%= Math.round(((product.originalPrice - product.price) / product.originalPrice) * 100) %>% OFF)
            </div>
          <% } else { %>
            <div class="text-4xl font-bold text-primary">
              $<%= product.price.toFixed(2) %>
            </div>
          <% } %>
        </div>

        <!-- Description -->
        <div class="prose max-w-none">
          <h3 class="text-lg font-semibold text-foreground">Descripción</h3>
          <p class="text-gray-700 mt-2"><%= product.description %></p>
        </div>

        <!-- Category and Actions -->
        <div class="border-t border-border pt-6 space-y-4">
          <p class="text-foreground">
            <strong>Categoría:</strong> <%= product.category %>
          </p>
          <p class="text-foreground">
            <strong>Código:</strong> <span class="font-mono text-sm"><%= product.code %></span>
          </p>
          
          <!-- Stock Availability Section -->
          <div class="bg-muted/50 rounded-lg p-4">
            <div class="flex items-center justify-between">
              <div class="flex items-center gap-2">
                <svg class="w-5 h-5 <%= product.stock > 0 ? 'text-success' : 'text-destructive' %>" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"></path>
                </svg>
                <span class="font-medium text-foreground">Disponibilidad:</span>
              </div>
              <% if (product.stock > 0) { %>
                <span class="text-success font-semibold">En Stock</span>
              <% } else { %>
                <span class="text-destructive font-semibold">Agotado</span>
              <% } %>
            </div>
            
            <% if (product.stock > 0) { %>
              <div class="mt-3 flex items-center gap-2">
                <div class="flex-1 bg-background rounded-full h-2 overflow-hidden">
                  <div 
                    class="h-full <%= product.stock < 10 ? 'bg-warning' : 'bg-success' %> transition-all"
                    style="width: <%= Math.min((product.stock / 100) * 100, 100) %>%"
                  ></div>
                </div>
                <span class="text-sm font-medium <%= product.stock < 10 ? 'text-warning' : 'text-success' %>">
                  <%= product.stock %> unidades
                </span>
              </div>
              
              <% if (product.stock < 10) { %>
                <p class="text-xs text-warning mt-2 flex items-center gap-1">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                  </svg>
                  ¡Últimas unidades disponibles!
                </p>
              <% } %>
            <% } else { %>
              <p class="text-sm text-muted-foreground mt-2">
                Este producto no está disponible actualmente. Vuelve pronto para más stock.
              </p>
            <% } %>
          </div>

          <div class="flex gap-3">
            <!-- Add to Cart Button -->
            <button
              class="btn-primary flex-1 flex items-center justify-center gap-2 add-to-cart-btn"
              data-product-id="<%= product.id %>"
              <%= product.stock === 0 ? 'disabled' : '' %>
            >
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"></path>
              </svg>
              <%= product.stock === 0 ? 'Agotado' : 'Agregar al Carrito' %>
            </button>

            <!-- Favorite Button -->
            <button
              class="w-12 h-12 bg-secondary rounded-lg flex items-center justify-center hover:bg-muted transition-colors favorite-btn"
              data-product-id="<%= product.id %>"
              data-is-favorite="<%= isFavorite %>"
            >
              <svg class="w-5 h-5 <%= isFavorite ? 'fill-red-500 text-red-500' : 'text-gray-400' %>" fill="<%= isFavorite ? 'currentColor' : 'none' %>" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
              </svg>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</main>

<script src="/js/cart.js"></script>
<script src="/js/favorites.js"></script>
